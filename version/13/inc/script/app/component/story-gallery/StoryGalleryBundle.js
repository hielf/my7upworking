var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("app/component/story-gallery/StoryGalleryController",["require","exports","lib/temple/component/AbstractComponentController","app/data/DataManager"],function(a,b,c,d){var e=function(a){function b(b,c){a.call(this,b,c),this.articleData=c.articleData}return __extends(b,a),b.prototype.init=function(){var b=this;a.prototype.init.call(this),d.getInstance().transitionInDone()?this.addData():this._subscriptions.push(d.getInstance().transitionInDone.subscribe(function(a){a&&b.addData()}))},b.prototype.addData=function(){var a=this;this.viewModel.title(this.articleData.title),this.viewModel.copy(this.articleData.copy),this.viewModel.images(this.articleData.images);for(var b=[],c=0;c<this.viewModel.images().length;c++)0==c?b.push({active:ko.observable(!0)}):b.push({active:ko.observable(!1)});this.viewModel.bullets(b),this.currentSlide=0,this.carouselFrame=$(this.element).find(".carousel .frame"),this.slidesContainer=$(this.element).find(".carousel .slides"),this._$footer=$("#page-footer"),$(window).on("resize"+this.eventNamespace,$.debounce(100,function(){a.onResize()})),this.onResize(),this.autoRotate()},b.prototype.onResize=function(){var a=this.carouselFrame.width(),b=this.carouselFrame.height();if(this.images=this.slidesContainer.find(".slide"),this.images.width(a),this.images.height(b),this.imageWidth=a,this.slidesContainer.width(this.images.length*a+50),d.getInstance().isTablet()){this._$footer||(this._$footer=$("#page-footer"));var c=$(this.element).find(".info").height()+$(this.element).find(".carousel").height(),e=c+200;$(this.element).height(e)}else $(this.element).css("height","")},b.prototype.autoRotate=function(){var a=this;this.rotateTimeout=setTimeout(function(){a.gotoNext()},1e4)},b.prototype.gotoSlide=function(a){clearTimeout(this.rotateTimeout);var b=0==a?0:this.imageWidth*a;TweenLite.to(this.slidesContainer,.5,{left:"-"+b+"px",ease:Power1.easeInOut}),this.setBullet(a),this.currentSlide=a,this.autoRotate()},b.prototype.gotoNext=function(){var a=this.currentSlide+1;a<this.viewModel.images().length?this.gotoSlide(a):this.gotoSlide(0)},b.prototype.gotoPrev=function(){var a=this.currentSlide-1;a>=0?this.gotoSlide(a):this.gotoSlide(this.viewModel.images().length-1)},b.prototype.setBullet=function(a){for(var b=0;b<this.viewModel.bullets().length;b++){var c=this.viewModel.bullets()[b];c.active(!1),b==a&&c.active(!0)}},b.prototype.destruct=function(){$(window).off("resize"+this.eventNamespace),this.articleData=null,this.slidesContainer=null,this.images=null,this.imageWidth=null,this.carouselFrame=null,this._$footer=null,clearTimeout(this.rotateTimeout),this.rotateTimeout=null,a.prototype.destruct.call(this)},b}(c);return e});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("app/component/story-gallery/StoryGalleryViewModel",["require","exports","lib/temple/component/AbstractComponentViewModel","knockout"],function(a,b,c,d){var e=function(a){function b(){a.call(this),this.title=d.observable(""),this.copy=d.observable(""),this.images=d.observableArray([]),this.bullets=d.observableArray([])}return __extends(b,a),b.prototype.gotoSlide=function(a){this.controller.gotoSlide(a())},b.prototype.destruct=function(){this.title=null,this.copy=null,this.images=null,this.bullets=null,a.prototype.destruct.call(this)},b}(c);return e}),define("text!app/component/story-gallery/story-gallery.html",[],function(){return'<div class="component-story-gallery">\r\n	<div class="content">\r\n		<div class="info">\r\n			<h3 data-bind="localizedText: {id: \'defaults.article.check_out_my_favorite_spot\', html: false}"></h3>\r\n			<h2 data-bind="html: title"></h2>\r\n			<div class="copy"><p data-bind="html: copy"></p></div>\r\n		</div>\r\n		<div class="carousel" data-bind="\r\n			swipeleft: controller.gotoNext.bind(controller),\r\n			swiperight: controller.gotoPrev.bind(controller)">\r\n			<div class="slides-wrap">\r\n				<div class="frame">\r\n					<div class="slides" data-bind="foreach: images">\r\n						<div class="slide" data-bind="style: { backgroundImage: \'url(\'+ $data +\')\' }"></div>\r\n					</div>\r\n				</div>\r\n			</div>\r\n			<div class="bullets" data-bind="foreach: bullets">\r\n				<div class="bullet" data-bind="\r\n					tap: function(){ $root.gotoSlide($index) },\r\n					css: { \'active\': active }"></div>\r\n			</div>\r\n		</div>\r\n	</div>\r\n</div>'}),define("app/component/story-gallery/StoryGalleryBundle",["require","exports","app/component/story-gallery/StoryGalleryController","app/component/story-gallery/StoryGalleryViewModel","text!app/component/story-gallery/story-gallery.html"],function(a,b,c,d,e){b.controller=c,b.viewmodel=d,b.template=e});
//# sourceMappingURL=../../../../sourcemap/app/component/story-gallery/StoryGalleryBundle.js.map