define(["require","exports","./Animate"],function(a,b,c){var d=function(a){return Math.pow(a-1,3)+1},e=function(a){return(a/=.5)<1?.5*Math.pow(a,3):.5*(Math.pow(a-2,3)+2)},f=function(){},g=function(){function a(a,b){void 0===b&&(b={}),this.options={scrollingX:!0,scrollingY:!0,animating:!0,animationDuration:250,bouncing:!0,locking:!0,paging:!1,snapping:!1,zooming:!1,minZoom:1,maxZoom:1,speedMultiplier:1,scrollingComplete:f,penetrationDeceleration:.03,penetrationAcceleration:.08},this.__isSingleTouch=!1,this.__isTracking=!1,this.__didDecelerationComplete=!1,this.__isGesturing=!1,this.__isDragging=!1,this.__isDecelerating=!1,this.__isAnimating=!1,this.__isAnimatingId=-1,this.__clientLeft=0,this.__clientTop=0,this.__clientWidth=0,this.__clientHeight=0,this.__contentWidth=0,this.__contentHeight=0,this.__snapWidth=100,this.__snapHeight=100,this.__refreshHeight=null,this.__refreshActive=!1,this.__refreshActivate=null,this.__refreshDeactivate=null,this.__refreshStart=null,this.__zoomLevel=1,this.__scrollLeft=0,this.__scrollTop=0,this.__maxScrollLeft=0,this.__maxScrollTop=0,this.__scheduledLeft=0,this.__scheduledTop=0,this.__scheduledZoom=0,this.__lastTouchLeft=null,this.__lastTouchTop=null,this.__lastTouchMove=null,this.__positions=null,this.__minDecelerationScrollLeft=null,this.__minDecelerationScrollTop=null,this.__maxDecelerationScrollLeft=null,this.__maxDecelerationScrollTop=null,this.__decelerationVelocityX=null,this.__decelerationVelocityY=null,this.__callback=a;for(var c in b)b.hasOwnProperty(c)&&(this.options[c]=b[c])}return a.prototype.setDimensions=function(a,b,c,d){var e=this;a===+a&&(e.__clientWidth=a),b===+b&&(e.__clientHeight=b),c===+c&&(e.__contentWidth=c),d===+d&&(e.__contentHeight=d),e.__computeScrollMax(),e.scrollTo(e.__scrollLeft,e.__scrollTop,!0)},a.prototype.setPosition=function(a,b){var c=this;c.__clientLeft=a||0,c.__clientTop=b||0},a.prototype.setSnapSize=function(a,b){this.__snapWidth=a,this.__snapHeight=b},a.prototype.activatePullToRefresh=function(a,b,c,d){var e=this;e.__refreshHeight=a,e.__refreshActivate=b,e.__refreshDeactivate=c,e.__refreshStart=d},a.prototype.triggerPullToRefresh=function(){this.__publish(this.__scrollLeft,-this.__refreshHeight,this.__zoomLevel,!0),this.__refreshStart&&this.__refreshStart()},a.prototype.finishPullToRefresh=function(){var a=this;a.__refreshActive=!1,a.__refreshDeactivate&&a.__refreshDeactivate(),a.scrollTo(a.__scrollLeft,a.__scrollTop,!0)},a.prototype.getValues=function(){var a=this;return{left:a.__scrollLeft,top:a.__scrollTop,zoom:a.__zoomLevel}},a.prototype.getScrollMax=function(){var a=this;return{left:a.__maxScrollLeft,top:a.__maxScrollTop}},a.prototype.zoomTo=function(a,b,d,e,f){var g=this;if(!g.options.zooming)throw new Error("Zooming is not enabled!");f&&(g.__zoomComplete=f),g.__isDecelerating&&(c.stop(g.__isDecelerating),g.__isDecelerating=!1);var h=g.__zoomLevel;null==d&&(d=g.__clientWidth/2),null==e&&(e=g.__clientHeight/2),a=Math.max(Math.min(a,g.options.maxZoom),g.options.minZoom),g.__computeScrollMax(a);var i=(d+g.__scrollLeft)*a/h-d,j=(e+g.__scrollTop)*a/h-e;i>g.__maxScrollLeft?i=g.__maxScrollLeft:0>i&&(i=0),j>g.__maxScrollTop?j=g.__maxScrollTop:0>j&&(j=0),g.__publish(i,j,a,b)},a.prototype.zoomBy=function(a,b,c,d,e){var f=this;f.zoomTo(f.__zoomLevel*a,b,c,d,e)},a.prototype.scrollTo=function(a,b,d,e){var f=this;if(f.__isDecelerating&&(c.stop(f.__isDecelerating),f.__isDecelerating=!1),null!=e&&e!==f.__zoomLevel){if(!f.options.zooming)throw new Error("Zooming is not enabled!");a*=e,b*=e,f.__computeScrollMax(e)}else e=f.__zoomLevel;f.options.scrollingX?f.options.paging?a=Math.round(a/f.__clientWidth)*f.__clientWidth:f.options.snapping&&(a=Math.round(a/f.__snapWidth)*f.__snapWidth):a=f.__scrollLeft,f.options.scrollingY?f.options.paging?b=Math.round(b/f.__clientHeight)*f.__clientHeight:f.options.snapping&&(b=Math.round(b/f.__snapHeight)*f.__snapHeight):b=f.__scrollTop,a=Math.max(Math.min(f.__maxScrollLeft,a),0),b=Math.max(Math.min(f.__maxScrollTop,b),0),a===f.__scrollLeft&&b===f.__scrollTop&&(d=!1),f.__publish(a,b,e,d)},a.prototype.scrollBy=function(a,b,c){var d=this,e=d.__isAnimating?d.__scheduledLeft:d.__scrollLeft,f=d.__isAnimating?d.__scheduledTop:d.__scrollTop;d.scrollTo(e+(a||0),f+(b||0),c)},a.prototype.doMouseZoom=function(a,b,c,d){var e=this,f=a>0?.97:1.03;return e.zoomTo(e.__zoomLevel*f,!1,c-e.__clientLeft,d-e.__clientTop)},a.prototype.doTouchStart=function(a,b){if(null==a.length)throw new Error("Invalid touch list: "+a);if(b instanceof Date&&(b=b.valueOf()),"number"!=typeof b)throw new Error("Invalid timestamp value: "+b);var d=this;d.__interruptedAnimation=!0,d.__isDecelerating&&(c.stop(d.__isDecelerating),d.__isDecelerating=!1,d.__interruptedAnimation=!0),d.__isAnimating&&(c.stop(d.__isAnimatingId),d.__isAnimating=!1,d.__isAnimatingId=-1,d.__interruptedAnimation=!0);var e,f,g=1===a.length;g?(e=a[0].pageX,f=a[0].pageY):(e=Math.abs(a[0].pageX+a[1].pageX)/2,f=Math.abs(a[0].pageY+a[1].pageY)/2),d.__initialTouchLeft=e,d.__initialTouchTop=f,d.__zoomLevelStart=d.__zoomLevel,d.__lastTouchLeft=e,d.__lastTouchTop=f,d.__lastTouchMove=b,d.__lastScale=1,d.__enableScrollX=!g&&d.options.scrollingX,d.__enableScrollY=!g&&d.options.scrollingY,d.__isTracking=!0,d.__didDecelerationComplete=!1,d.__isDragging=!g,d.__isSingleTouch=g,d.__positions=[]},a.prototype.doTouchMove=function(a,b,c){if(void 0===c&&(c=null),null==a.length)throw new Error("Invalid touch list: "+a);if(b instanceof Date&&(b=b.valueOf()),"number"!=typeof b)throw new Error("Invalid timestamp value: "+b);var d=this;if(d.__isTracking){var e,f;2===a.length?(e=Math.abs(a[0].pageX+a[1].pageX)/2,f=Math.abs(a[0].pageY+a[1].pageY)/2):(e=a[0].pageX,f=a[0].pageY);var g=d.__positions;if(d.__isDragging){var h=e-d.__lastTouchLeft,i=f-d.__lastTouchTop,j=d.__scrollLeft,k=d.__scrollTop,l=d.__zoomLevel;if(null!=c&&d.options.zooming){var m=l;if(l=l/d.__lastScale*c,l=Math.max(Math.min(l,d.options.maxZoom),d.options.minZoom),m!==l){var n=e-d.__clientLeft,o=f-d.__clientTop;j=(n+j)*l/m-n,k=(o+k)*l/m-o,d.__computeScrollMax(l)}}if(d.__enableScrollX){j-=h*this.options.speedMultiplier;var p=d.__maxScrollLeft;(j>p||0>j)&&(d.options.bouncing?j+=h/2*this.options.speedMultiplier:j=j>p?p:0)}if(d.__enableScrollY){k-=i*this.options.speedMultiplier;var q=d.__maxScrollTop;(k>q||0>k)&&(d.options.bouncing?(k+=i/2*this.options.speedMultiplier,d.__enableScrollX||null==d.__refreshHeight||(!d.__refreshActive&&k<=-d.__refreshHeight?(d.__refreshActive=!0,d.__refreshActivate&&d.__refreshActivate()):d.__refreshActive&&k>-d.__refreshHeight&&(d.__refreshActive=!1,d.__refreshDeactivate&&d.__refreshDeactivate()))):k=k>q?q:0)}g.length>60&&g.splice(0,30),g.push(j,k,b),d.__publish(j,k,l)}else{var r=d.options.locking?3:0,s=5,t=Math.abs(e-d.__initialTouchLeft),u=Math.abs(f-d.__initialTouchTop);d.__enableScrollX=d.options.scrollingX&&t>=r,d.__enableScrollY=d.options.scrollingY&&u>=r,g.push(d.__scrollLeft,d.__scrollTop,b),d.__isDragging=(d.__enableScrollX||d.__enableScrollY)&&(t>=s||u>=s),d.__isDragging&&(d.__interruptedAnimation=!1)}d.__lastTouchLeft=e,d.__lastTouchTop=f,d.__lastTouchMove=b,d.__lastScale=c}},a.prototype.doTouchEnd=function(a){if("number"!=typeof a)throw new Error("Invalid timestamp value: "+a);var b=this;if(b.__isTracking){if(b.__isTracking=!1,b.__isDragging)if(b.__isDragging=!1,b.__isSingleTouch&&b.options.animating&&a-b.__lastTouchMove<=100){for(var c=b.__positions,d=c.length-1,e=d,f=d;f>0&&c[f]>b.__lastTouchMove-100;f-=3)e=f;if(e!==d){var g=c[d]-c[e],h=b.__scrollLeft-c[e-2],i=b.__scrollTop-c[e-1];b.__decelerationVelocityX=h/g*(1e3/60),b.__decelerationVelocityY=i/g*(1e3/60);var j=b.options.paging||b.options.snapping?4:1;(Math.abs(b.__decelerationVelocityX)>j||Math.abs(b.__decelerationVelocityY)>j)&&(b.__refreshActive||b.__startDeceleration(a))}else b.options.scrollingComplete()}else a-b.__lastTouchMove>100&&b.options.scrollingComplete();b.__isDecelerating||(b.__refreshActive&&b.__refreshStart?(b.__publish(b.__scrollLeft,-b.__refreshHeight,b.__zoomLevel,!0),b.__refreshStart&&b.__refreshStart()):((b.__interruptedAnimation||b.__isDragging)&&b.options.scrollingComplete(),b.scrollTo(b.__scrollLeft,b.__scrollTop,!0,b.__zoomLevel),b.__refreshActive&&(b.__refreshActive=!1,b.__refreshDeactivate&&b.__refreshDeactivate()))),b.__positions.length=0}},a.prototype.__publish=function(a,b,f,g){void 0===g&&(g=!1);var h=this,i=h.__isAnimatingId;if(i&&(c.stop(i),h.__isAnimatingId=-1,h.__isAnimating=!!h.__isAnimatingId),g&&h.options.animating){h.__scheduledLeft=a,h.__scheduledTop=b,h.__scheduledZoom=f;var j=h.__scrollLeft,k=h.__scrollTop,l=h.__zoomLevel,m=a-j,n=b-k,o=f-l,p=function(a,b,c){c&&(h.__scrollLeft=j+m*a,h.__scrollTop=k+n*a,h.__zoomLevel=l+o*a,h.__callback&&h.__callback(h.__scrollLeft,h.__scrollTop,h.__zoomLevel))},q=function(a){return h.__isAnimatingId===a},r=function(a,b,c){b===h.__isAnimatingId&&(h.__isAnimatingId=-1,h.__isAnimating=!!h.__isAnimatingId),(h.__didDecelerationComplete||c)&&h.options.scrollingComplete(),h.options.zooming&&(h.__computeScrollMax(),h.__zoomComplete&&(h.__zoomComplete(),h.__zoomComplete=null))};h.__isAnimatingId=c.start(p,q,r,1e3,i?d:e),h.__isAnimating=!!h.__isAnimatingId}else h.__scheduledLeft=h.__scrollLeft=a,h.__scheduledTop=h.__scrollTop=b,h.__scheduledZoom=h.__zoomLevel=f,h.__callback&&h.__callback(a,b,f),h.options.zooming&&(h.__computeScrollMax(),h.__zoomComplete&&(h.__zoomComplete(),h.__zoomComplete=null))},a.prototype.__computeScrollMax=function(a){void 0===a&&(a=this.__zoomLevel);var b=this;b.__maxScrollLeft=Math.max(b.__contentWidth*a-b.__clientWidth,0),b.__maxScrollTop=Math.max(b.__contentHeight*a-b.__clientHeight,0)},a.prototype.__startDeceleration=function(a){var b=this;if(b.options.paging){var d=Math.max(Math.min(b.__scrollLeft,b.__maxScrollLeft),0),e=Math.max(Math.min(b.__scrollTop,b.__maxScrollTop),0),f=b.__clientWidth,g=b.__clientHeight;b.__minDecelerationScrollLeft=Math.floor(d/f)*f,b.__minDecelerationScrollTop=Math.floor(e/g)*g,b.__maxDecelerationScrollLeft=Math.ceil(d/f)*f,b.__maxDecelerationScrollTop=Math.ceil(e/g)*g}else b.__minDecelerationScrollLeft=0,b.__minDecelerationScrollTop=0,b.__maxDecelerationScrollLeft=b.__maxScrollLeft,b.__maxDecelerationScrollTop=b.__maxScrollTop;var h=function(a,c,d){b.__stepThroughDeceleration(d)},i=b.options.snapping?4:.1,j=function(){var a=Math.abs(b.__decelerationVelocityX)>=i||Math.abs(b.__decelerationVelocityY)>=i;return a||(b.__didDecelerationComplete=!0),a},k=function(a,c,d){b.__isDecelerating=!1,b.__didDecelerationComplete&&b.options.scrollingComplete(),b.scrollTo(b.__scrollLeft,b.__scrollTop,b.options.snapping)};b.__isDecelerating=!!c.start(h,j,k)},a.prototype.__stepThroughDeceleration=function(a){var b=this,c=b.__scrollLeft+b.__decelerationVelocityX,d=b.__scrollTop+b.__decelerationVelocityY;if(!b.options.bouncing){var e=Math.max(Math.min(b.__maxDecelerationScrollLeft,c),b.__minDecelerationScrollLeft);e!==c&&(c=e,b.__decelerationVelocityX=0);var f=Math.max(Math.min(b.__maxDecelerationScrollTop,d),b.__minDecelerationScrollTop);f!==d&&(d=f,b.__decelerationVelocityY=0)}if(a?b.__publish(c,d,b.__zoomLevel):(b.__scrollLeft=c,b.__scrollTop=d),!b.options.paging){var g=.95;b.__decelerationVelocityX*=g,b.__decelerationVelocityY*=g}if(b.options.bouncing){var h=0,i=0,j=b.options.penetrationDeceleration,k=b.options.penetrationAcceleration;c<b.__minDecelerationScrollLeft?h=b.__minDecelerationScrollLeft-c:c>b.__maxDecelerationScrollLeft&&(h=b.__maxDecelerationScrollLeft-c),d<b.__minDecelerationScrollTop?i=b.__minDecelerationScrollTop-d:d>b.__maxDecelerationScrollTop&&(i=b.__maxDecelerationScrollTop-d),0!==h&&(h*b.__decelerationVelocityX<=0?b.__decelerationVelocityX+=h*j:b.__decelerationVelocityX=h*k),0!==i&&(i*b.__decelerationVelocityY<=0?b.__decelerationVelocityY+=i*j:b.__decelerationVelocityY=i*k)}},a}();return g});
//# sourceMappingURL=../../../sourcemap/lib/zynga/Scroller.js.map