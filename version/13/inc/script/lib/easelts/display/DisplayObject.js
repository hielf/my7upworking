var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define(["require","exports","../../createts/event/EventDispatcher","../util/UID","../util/Methods","./Shadow","../enum/CalculationType","../enum/DisplayType","../geom/FluidCalculation","../geom/Matrix2","../geom/Rectangle","../geom/Size","../geom/Point"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=function(a){function b(b,c,e,f,g,h){void 0===b&&(b="100%"),void 0===c&&(c="100%"),void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=0),void 0===h&&(h=0),a.call(this),this.type=3,this.alpha=1,this.cacheCanvas=null,this.id=d.get(),this.mouseEnabled=!1,this.tickEnabled=!0,this.name=null,this.parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.stage=null,this.updateGeomOnResize=!0,this.width=0,this.height=0,this._x_type=2,this._x_procent=0,this._y_procent=0,this._width_type=2,this._width_procent=0,this._height_type=2,this._height_procent=0,this._regX_type=2,this._regX_procent=0,this._regY_type=2,this._regY_procent=0,this._behaviorList=null,this._parentSizeIsKnown=!1,this.minimumContainerSize=null,this.maximumContainerSize=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,this.cacheID=0,this.mask=null,this.hitArea=null,this.cursor=null,this._cacheOffsetX=0,this._cacheOffsetY=0,this._cacheScale=1,this._cacheDataURLID=0,this._cacheDataURL=null,this._matrix=new j.Matrix2(0,0,0,0,0,0),this._rectangle=new k(0,0,0,0),this._bounds=null,this.DisplayObject_draw=this.draw,this.DisplayObject_getBounds=this._getBounds,this.setGeomTransform(b,c,e,f,g,h)}return __extends(b,a),b.prototype.initialize=function(){},b.prototype.dot=function(a){return this.x*a.x+this.y*a.y},b.prototype.distanceToSquared=function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},b.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},b.prototype.setWidth=function(a){return"string"==typeof a?"%"==a.substr(-1)?(this._width_procent=parseFloat(a.substr(0,a.length-1))/100,this._width_type=1):(this._width_calc=i.dissolveCalcElements(a),this._width_type=3):(this.width=a,this._width_type=2),this._parentSizeIsKnown&&this.onResize(new l(this.parent.width,this.parent.height)),this},b.prototype.getWidth=function(){return this.width},b.prototype.setHeight=function(a){return"string"==typeof a?"%"==a.substr(-1)?(this._height_procent=parseFloat(a.substr(0,a.length-1))/100,this._height_type=1):(this._height_calc=i.dissolveCalcElements(a),this._height_type=3):(this.height=a,this._height_type=2),this._parentSizeIsKnown&&this.onResize(new l(this.parent.width,this.parent.height)),this},b.prototype.getHeight=function(){return this.height},b.prototype.setX=function(a){return"string"==typeof a?"%"==a.substr(-1)?(this._x_procent=parseFloat(a.substr(0,a.length-1))/100,this._x_type=1):(this._x_calc=i.dissolveCalcElements(a),this._x_type=3):(this.x=a,this._x_type=2),this._parentSizeIsKnown&&this.onResize(new l(this.parent.width,this.parent.height)),this},b.prototype.getX=function(){return this.x},b.prototype.setY=function(a){return"string"==typeof a?"%"==a.substr(-1)?(this._y_procent=parseFloat(a.substr(0,a.length-1))/100,this._y_type=1):(this._y_calc=i.dissolveCalcElements(a),this._y_type=3):(this.y=a,this._y_type=2),this._parentSizeIsKnown&&this.onResize(new l(this.parent.width,this.parent.height)),this},b.prototype.getY=function(){return this.y},b.prototype.setRegX=function(a){return"string"==typeof a?"%"==a.substr(-1)?(this._regX_procent=parseFloat(a.substr(0,a.length-1))/100,this._regX_type=1):(this._regX_calc=i.dissolveCalcElements(a),this._regX_type=3):(this.regX=a,this._regX_type=2),this._parentSizeIsKnown&&this.onResize(new l(this.parent.width,this.parent.height)),this},b.prototype.getRegX=function(){return this.regX},b.prototype.setRegY=function(a){return"string"==typeof a?"%"==a.substr(-1)?(this._regY_procent=parseFloat(a.substr(0,a.length-1))/100,this._regY_type=1):(this._regY_calc=i.dissolveCalcElements(a),this._regY_type=3):(this.regY=a,this._regY_type=2),this._parentSizeIsKnown&&this.onResize(new l(this.parent.width,this.parent.height)),this},b.prototype.getRegY=function(){return this.regY},b.prototype.addBehavior=function(a){return this._behaviorList||(this._behaviorList=[]),this._behaviorList.push(a),a.initialize(this),this},b.prototype.removeBehavior=function(a){var b=this._behaviorList;if(b)for(var c=b.length,d=0;d<b.length;d++){var e=b[d];e===a&&(b.splice(d,1),c--,d--)}return this},b.prototype.removeAllBehaviors=function(){if(this._behaviorList)for(;this._behaviorList.length;)this._behaviorList.pop().destruct()},b.prototype.enableMouseInteraction=function(){this.mouseEnabled=!0},b.prototype.disableMouseInteraction=function(){this.mouseEnabled=!1},b.prototype.isVisible=function(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)},b.prototype.draw=function(a,b){var c=this.cacheCanvas;if(b||!c)return!1;var d,e=this._cacheScale,f=this._cacheOffsetX,g=this._cacheOffsetY;return(d=this._applyFilterBounds(f,g,0,0))&&(f=d.x,g=d.y),a.drawImage(c,f,g,c.width/e,c.height/e),!0},b.prototype.updateContext=function(a){var c,d=this.mask,e=this;d&&d.graphics&&!d.graphics.isEmpty()&&(c=d.getMatrix(d._matrix),a.transform(c.a,c.b,c.c,c.d,c.tx,c.ty),d.graphics.drawAsPath(a),a.clip(),c.invert(),a.transform(c.a,c.b,c.c,c.d,c.tx,c.ty)),c=e._matrix.identity().appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY);var f=c.tx,g=c.ty;b._snapToPixelEnabled&&e.snapToPixel&&(f=f+(0>f?-.5:.5)|0,g=g+(0>g?-.5:.5)|0),a.transform(c.a,c.b,c.c,c.d,f,g),a.globalAlpha*=e.alpha,e.compositeOperation&&(a.globalCompositeOperation=e.compositeOperation),e.shadow&&this._applyShadow(a,e.shadow)},b.prototype.cache=function(a,b,c,d,f){void 0===f&&(f=1),this.cacheCanvas||(this.cacheCanvas=e.createCanvas()),this._cacheWidth=c,this._cacheHeight=d,this._cacheOffsetX=a,this._cacheOffsetY=b,this._cacheScale=f,this.updateCache()},b.prototype.updateCache=function(a){var c,d=this.cacheCanvas,e=this._cacheScale,f=this._cacheOffsetX*e,g=this._cacheOffsetY*e,h=this._cacheWidth,i=this._cacheHeight;if(!d)throw"cache() must be called before updateCache()";var j=d.getContext("2d");(c=this._applyFilterBounds(f,g,h,i))&&(f=c.x,g=c.y,h=c.width,i=c.height),h=Math.ceil(h*e),i=Math.ceil(i*e),h!=d.width||i!=d.height?(d.width=h,d.height=i):a||j.clearRect(0,0,h+1,i+1),j.save(),j.globalCompositeOperation=a,j.setTransform(e,0,0,e,-f,-g),this.draw(j,!0),this._applyFilters(),j.restore(),this.cacheID=b._nextCacheID++},b.prototype.uncache=function(){this._cacheDataURL=this.cacheCanvas=null,this.cacheID=this._cacheOffsetX=this._cacheOffsetY=0,this._cacheScale=1},b.prototype.getCacheDataURL=function(){return this.cacheCanvas?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURL=this.cacheCanvas.toDataURL()),this._cacheDataURL):null},b.prototype.getStage=function(){for(var a=this;a.parent;)a=a.parent;return 1==a.type?a:null},b.prototype.localToGlobal=function(a,b){var c=this.getConcatenatedMatrix(this._matrix);return null==c?null:(c.append(1,0,0,1,a,b),new m(c.tx,c.ty))},b.prototype.globalToLocal=function(a,b){var c=this.getConcatenatedMatrix(this._matrix);return null==c?null:(c.invert(),c.append(1,0,0,1,a,b),new m(c.tx,c.ty))},b.prototype.localToLocal=function(a,b,c){var d=this.localToGlobal(a,b);return c.globalToLocal(d.x,d.y)},b.prototype.setTransform=function(a,b,c,d,e,f,g,h,i){return this.x=a||0,this.y=b||0,this.scaleX=null==c?1:c,this.scaleY=null==d?1:d,this.rotation=e||0,this.skewX=f||0,this.skewY=g||0,this.regX=h||0,this.regY=i||0,this},b.prototype.setGeomTransform=function(a,b,c,d,e,f){void 0===a&&(a=null),void 0===b&&(b=null),void 0===c&&(c=null),void 0===d&&(d=null),void 0===e&&(e=null),void 0===f&&(f=null);var g=this._parentSizeIsKnown;return this._parentSizeIsKnown=!1,null!=c&&this.setX(c),null!=d&&this.setY(d),null!=a&&this.setWidth(a),null!=b&&this.setHeight(b),null!=e&&this.setRegX(e),null!=f&&this.setRegY(f),this._parentSizeIsKnown=g,this._parentSizeIsKnown&&this.onResize(new l(this.parent.width,this.parent.height)),this},b.prototype.getMatrix=function(a){var b=this;return(a?a.identity():new j.Matrix2(0,0,0,0,0,0)).appendTransform(b.x,b.y,b.scaleX,b.scaleY,b.rotation,b.skewX,b.skewY,b.regX,b.regY).appendProperties(b.alpha,b.shadow,b.compositeOperation,1)},b.prototype.getConcatenatedMatrix=function(a){a?a.identity():a=new j.Matrix2(0,0,0,0,0,0);for(var b=this;null!=b;)a.prependTransform(b.x,b.y,b.scaleX,b.scaleY,b.rotation,b.skewX,b.skewY,b.regX,b.regY).prependProperties(b.alpha,b.shadow,b.compositeOperation,b.visible),b=b.parent;return a},b.prototype.hitTest=function(a,c){var d=b._hitTestContext;d.setTransform(1,0,0,1,-a,-c),this.draw(d);var e=this._testHit(d);return d.setTransform(1,0,0,1,0,0),d.clearRect(0,0,2,2),e},b.prototype.set=function(a){for(var b in a)this[b]=a[b];return this},b.prototype.getBounds=function(){if(this._bounds)return this._rectangle.copy(this._bounds);var a=this.cacheCanvas;if(a){var b=this._cacheScale;return this._rectangle.initialize(this._cacheOffsetX,this._cacheOffsetY,a.width/b,a.height/b)}return null},b.prototype.getTransformedBounds=function(){return this._getBounds()},b.prototype.setBounds=function(a,b,c,d){null==a&&(this._bounds=null),this._bounds=this._bounds||new k(a,b,c,d)},b.prototype.clone=function(a){var c=new b;return this.cloneProps(c),c},b.prototype.toString=function(){return"[DisplayObject (name="+this.name+")]"},b.prototype.cloneProps=function(a){a.alpha=this.alpha,a.name=this.name,a.regX=this.regX,a.regY=this.regY,a.rotation=this.rotation,a.scaleX=this.scaleX,a.scaleY=this.scaleY,a.shadow=this.shadow,a.skewX=this.skewX,a.skewY=this.skewY,a.visible=this.visible,a.x=this.x,a.y=this.y,a._bounds=this._bounds,a.mouseEnabled=this.mouseEnabled,a.compositeOperation=this.compositeOperation},b.prototype._applyShadow=function(a,b){b=b||f.identity,a.shadowColor=b.color,a.shadowOffsetX=b.offsetX,a.shadowOffsetY=b.offsetY,a.shadowBlur=b.blur},b.prototype.onTick=function(a){},b.prototype._testHit=function(a){try{var c=a.getImageData(0,0,1,1).data[3]>1}catch(d){if(!b.suppressCrossDomainErrors)throw new Error("An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images.")}return c},b.prototype._applyFilters=function(){if(this.filters&&0!=this.filters.length&&this.cacheCanvas)for(var a=this.filters.length,b=this.cacheCanvas.getContext("2d"),c=this.cacheCanvas.width,d=this.cacheCanvas.height,e=0;a>e;e++)this.filters[e].applyFilter(b,0,0,c,d)},b.prototype._applyFilterBounds=function(a,b,c,d){var e,f,g=this.filters;if(!g||!(f=g.length))return null;for(var h=0;f>h;h++){var i=this.filters[h],j=i.getBounds&&i.getBounds();j&&(e||(e=this._rectangle.initialize(a,b,c,d)),e.x+=j.x,e.y+=j.y,e.width+=j.width,e.height+=j.height)}return e},b.prototype._getBounds=function(a,b){return this._transformBounds(this.getBounds(),a,b)},b.prototype._transformBounds=function(a,b,c){if(!a)return a;var d=a.x,e=a.y,f=a.width,g=a.height,h=c?this._matrix.identity():this.getMatrix(this._matrix);(d||e)&&h.appendTransform(0,0,1,1,0,0,0,-d,-e),b&&h.prependMatrix(b);var i=f*h.a,j=f*h.b,k=g*h.c,l=g*h.d,m=h.tx,n=h.ty,o=m,p=m,q=n,r=n;return(d=i+m)<o?o=d:d>p&&(p=d),(d=i+k+m)<o?o=d:d>p&&(p=d),(d=k+m)<o?o=d:d>p&&(p=d),(e=j+n)<q?q=e:e>r&&(r=e),(e=j+l+n)<q?q=e:e>r&&(r=e),(e=l+n)<q?q=e:e>r&&(r=e),a.initialize(o,q,p-o,r-q)},b.prototype._hasMouseEventListener=function(){for(var a=b._MOUSE_EVENTS,c=0,d=a.length;d>c;c++)if(this.hasEventListener(a[c]))return!0;return null!=this.cursor},b.prototype.onStageSet=function(){},b.prototype.onResize=function(a){if(this._parentSizeIsKnown=!0,this.updateGeomOnResize){if(this.minimumContainerSize||this.maximumContainerSize){var b=this.minimumContainerSize;this.scaleX=this.scaleY=Math.min(1,a.width/b.width,a.height/b.height)}1==this._width_type?this.width=this._width_procent*a.width:3==this._width_type&&(this.width=i.calcUnit(a.width,this._width_calc)),1==this._height_type?this.height=this._height_procent*a.height:3==this._height_type&&(this.height=i.calcUnit(a.height,this._height_calc)),1==this._regX_type?this.regX=this._regX_procent*this.width:3==this._regX_type&&(this.regX=i.calcUnit(this.width,this._regX_calc)),1==this._regY_type?this.regY=this._regY_procent*this.height:3==this._regY_type&&(this.regY=i.calcUnit(this.height,this._height_calc)),1==this._x_type?this.x=Math.round(this._x_procent*a.width):3==this._x_type&&(this.x=Math.round(i.calcUnit(a.width,this._x_calc))),1==this._y_type?this.y=Math.round(this._y_procent*a.height):3==this._y_type&&(this.y=Math.round(i.calcUnit(a.height,this._y_calc)))}},b.prototype.destruct=function(){this.parent=null,this.removeAllBehaviors(),a.prototype.destruct.call(this)},b.EVENT_MOUSE_CLICK="click",b.EVENT_MOUSE_DOWN="mousedown",b.EVENT_MOUSE_OUT="mouseout",b.EVENT_MOUSE_OVER="mouseover",b.EVENT_MOUSE_MOVE="mousemove",b.EVENT_PRESS_MOVE="pressmove",b.EVENT_PRESS_UP="pressup",b.EVENT_ROLL_OUT="rollout",b.EVENT_ROLL_OVER="rollover",b.EVENT_POINTER_CLICK="click",b.EVENT_POINTER_DOWN="mousedown",b.EVENT_POINTER_MOVE="mousemove",b.EVENT_POINTER_UP="pressup",b.EVENT_POINTER_CANCEL="mousedown",b.EVENT_POINTER_ENTER="mouseover",b.EVENT_POINTER_LEAVE="mouseout",b.EVENT_POINTER_OUT="mouseout",b.EVENT_POINTER_OVER="mouseover",b._MOUSE_EVENTS=[b.EVENT_MOUSE_CLICK,b.EVENT_MOUSE_DOWN,b.EVENT_MOUSE_OUT,b.EVENT_MOUSE_OVER,b.EVENT_PRESS_MOVE,b.EVENT_PRESS_UP,b.EVENT_ROLL_OUT,b.EVENT_ROLL_OVER,"dblclick"],b.COMPOSITE_OPERATION_SOURCE_ATOP="source-atop",b.COMPOSITE_OPERATION_SOURCE_IN="source-in",b.COMPOSITE_OPERATION_SOURCE_OUT="source-out",b.COMPOSITE_OPERATION_SOURCE_OVER="source-over",b.COMPOSITE_OPERATION_DESTINATION_ATOP="destination-atop",b.COMPOSITE_OPERATION_DESTINATION_IN="destination-in",b.COMPOSITE_OPERATION_DESTINATION_OUT="destination-out",b.COMPOSITE_OPERATION_DESTINATION_OVER="destination-over",b.COMPOSITE_OPERATION_LIGHTER="lighter",b.COMPOSITE_OPERATION_DARKER="darker",b.COMPOSITE_OPERATION_XOR="xor",b.COMPOSITE_OPERATION_COPY="copy",b.suppressCrossDomainErrors=!1,b._snapToPixelEnabled=!1,b._hitTestCanvas=e.createCanvas(),b._hitTestContext=b._hitTestCanvas.getContext("2d"),b._nextCacheID=1,b}(c);return n});
//# sourceMappingURL=../../../../sourcemap/lib/easelts/display/DisplayObject.js.map